<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
    

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.4"/>


    <meta name="description" content="重新发现、定义并创造这个世界..." />



  <meta name="keywords" content="Hexo,next" />





  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.4" />


<meta name="description" content="重新发现、定义并创造这个世界...">
<meta property="og:type" content="website">
<meta property="og:title" content="sabria">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="sabria">
<meta property="og:description" content="重新发现、定义并创造这个世界...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="sabria">
<meta name="twitter:description" content="重新发现、定义并创造这个世界...">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'hide'
  };
</script>

    <title> sabria </title>
</head>
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">
<!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->




<div class="container one-column 
   page-home 
">
    <div class="headband"></div>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-logo"></i>
      </span>
      <span class="site-title">sabria</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-archives"></i> <br />
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-tags"></i> <br />
            标签
          </a>
        </li>
      
    </ul>
  

  
</nav>


        </div>
    </header>

    <main id="main" class="main">
        <div class="main-inner">
            <div id="content" class="content">
                
  <section id="posts" class="posts-expand">
    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/10/23/ZT11_1/" itemprop="url">
                【正谈10月】Explore NoSql on Android
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-10-23T23:45:48+08:00" content="2015-10-23">
            2015-10-23
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <h2 id="一-前言">一.前言</h2><p>D.Richard Hipp不曾想到在这一年他萌芽的轻量级数据库居然诞生在一条漂泊在大海的军舰上，这个诞生于2000年8月的Sqlite数据库由13万行C代码构成,轻量简洁稳定的优势特点,使它经过多年的发展成为Google&amp;Apple在移动端上探索数据库的核心主力，广泛而且大量的被使用。9年后,也就是2009年，NoSql形态数据库被逐渐推上历史的舞蹈核心，Mongodb在服务端架构数据库中大行其道，许多中小型数据库均开始由MySql转向更友好形态的Mongodb.而此时距离iphone1代发布已经过去了整整2年。<br>尽管如此，但在移动端领域NoSql形态数据库仍然还是处于萌芽起步阶段，在写这篇博客时我不经问自己:在Android上探索NoSql型数据库是否为时尚早?也许我们仍然需要时间来检验这个问题和它可能存在的标准答案！</p>
<h2 id="二-何为Nosql">二.何为Nosql</h2><p>泛指非关系型的数据库，关系数据库关注在关系上，NoSQL关注在存储上。<br>NoSQL数据库种类繁多，但是一个共同的特点都是去掉了关系数据库的关系型特性。数据之间无关系，容易扩展。<br>当前主流四种主要形态的NoSql型数据库：</p>
<ul>
<li><em>键值（key-value）比如：Oracle BDB</em></li>
<li><em>列存储数据库 比如：HBase</em></li>
<li><em>文档型数据库 比如：MongoDb</em></li>
<li><em>图形(Graph)数据库 比如：Infinite Graph</em></li>
</ul>
<p>主流的Nosql型数据库在Android端的探索主要是以key-value键值对的形式存在。这一类数据库主要会使用到一个哈希表，这个表中有一个特定的键和一个指针指向特定的数据。Key/value模型对于IT系统来说的优势在于简单、易部署。但是如果DBA只对部分值进行查询或更新的时候，Key/value就显得效率低下了。</p>
<p>使用场景：</p>
<ul>
<li><em>1.取代SP存储；</em></li>
<li><em>2.用于缓存场景.</em></li>
</ul>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/10/23/ZT11_1/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/10/23/LB_D/" itemprop="url">
                【杂谈10月】Library-Everyday-Gitbook上线
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-10-23T23:45:48+08:00" content="2015-10-23">
            2015-10-23
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <p>&emsp;&emsp;其实准确的说应该是今天凌晨1点钟完成上线，今天又用了一天时间完善了昨天(10/22)、今天(10/23)和明天(10/24)三天的library.</p>
<h2 id="1-为什么要做这个gitbook">1.为什么要做这个gitbook</h2><p>&emsp;&emsp;其实之前一直都想把自己每天学习和浏览的印记记录下来，一方面是有时经常fork 优秀的library,隔一段时间就忘记了。二是想做一个不同于其他网站或者博客的library库。</p>
<p>&emsp;&emsp;国内有很多优秀的开源和共享主义者都会经常分享一些优秀的library，但他们的library一般都只分享给中国开发者。我想尝试的是站在中国开发者的角度为老外们来点咱中国人的干货。</p>
<h2 id="2-这个gitbook主要是给中国开发者看的吗，为什么有中文的释义">2.这个gitbook主要是给中国开发者看的吗，为什么有中文的释义</h2><p>&emsp;&emsp;说实话，不是，主要是给老外看的。<br>&emsp;&emsp;中文释义一方面是方便我自己最快速的查看库的内容【苦笑】(谁让我中文这么好)。另一方面是给“英文不比我好”的中国Android开发同仁看的。</p>
<h2 id="3-听说你更新一个AndroidEveryday要花2个小时，不就几个libraries一列举吗,搞怎么麻烦">3.听说你更新一个AndroidEveryday要花2个小时，不就几个libraries一列举吗,搞怎么麻烦</h2><p>&emsp;&emsp;这个要重点解释下，因为为了照顾国外开发者，同时国外很多优秀的文章的图片在国内访问也很慢。鉴于技术网络环境问题。所以我采取的是，将所有的图片都下载或者右键另存为本地资源后，做裁剪和压缩后上传到github或者markdown。有时一排要放两个图片，为了美观我需要将高度都定为同一个值(比如500px)，此时就要用ps或者美图秀秀这样的工具操作咯。其实1个小时不到写完本日的AndroidEveryday，但是要花30多分钟处理图片。同时还要将完成的AndroidEveryday系列Push到3个地方更新：</p>
<pre><code>1<span class="class">.gitHub</span>的<span class="tag">README</span><span class="class">.md</span>
2<span class="class">.gitbook</span>的内页<span class="class">.md</span>
3.个人博客
</code></pre><p>&emsp;&emsp;很多博客的英文原文网站如果不翻墙根本打不开，虽然有VPN，但是速度也不是很快。gitbook的速度即使在VPN下也慢如蜗牛。这种痛苦，作为搞技术的你也是应该懂的。</p>
<p>&emsp;&emsp;同时每周日都需有精心准备的专题策划(先透露下10月25日本周日的第一次“周日策划专题”是我们的Jake Wharton大神周刊，期待哦)。</p>
<pre><code>搜索优秀Library + 排版 + 关键信息整理 + 图片处理 + 更新 = <span class="number">2</span>小时！
</code></pre><p>&emsp;&emsp;所以木办法，精益求精，要做就做好，绝不敷衍！</p>
<h2 id="4-真的是天天更新吗，来源哪里">4.真的是天天更新吗，来源哪里</h2><p>&emsp;&emsp;对，没错，必须的。一方面是提醒自己要有责任心，说出来的话就要做到。另一方面是，一个人在一个领域耕耘7年，就能成为这个领域的专家，坚持不懈的学习很重要。这不仅是份能够养活自己的工作，而且是自己追求开源精神的重要过程。</p>
<p>&emsp;&emsp;来源：(暂时来源，不排除以后收集推荐的)</p>
<pre><code><span class="number">1.</span>自己每天浏览相关技术网站后收集；
<span class="number">2.</span>自己摆弄github search;
<span class="number">3.</span>项目中遇到问题后查询相关信息偶然发现;
</code></pre><h2 id="5-有些英文有些生硬，怕老外看的懂吗">5.有些英文有些生硬，怕老外看的懂吗</h2><p>&emsp;&emsp;说实话是有点担心，不过，英文就这水平，看的”小”懂，发音烂，口齿不清。呵呵，所以笨鸟必须天天飞。</p>
<h2 id="6-同事说：作为搞技术的，你其实文笔不错，说让你出书,你怎么看">6.同事说：作为搞技术的，你其实文笔不错，说让你出书,你怎么看</h2><p>&emsp;&emsp;呵呵，中国国内的一坨烂书，这里抄抄、那里抄抄，只会圈钱，误人子弟。我能力不够，不会出书。做人要对得起自己的良心，自己水平不够，绝不误人子弟，赚黑心钱。</p>
<h2 id="7-未来博客和Gitbook的发展和更新">7.未来博客和Gitbook的发展和更新</h2><p>&emsp;&emsp;首先每天都要更新AndroidEveryday系列.同时还有好几篇博文都欠债下来了。现在公司APP也在开发，比较忙，所以有时请谅解。其次本年一定完成所有的范式编程系列文章。久等了啊！</p>
<p>&emsp;&emsp;最后再次表达下本人的理念：</p>
<pre><code>取之于开源，必最终回归于开源，此谓之：大道！
</code></pre><p>&emsp;&emsp;下面是这三天的AndroidEveryday，算是Demo小样，博客中也雅俗共赏下咯，看看和github的排版有什么不同。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/10/23/LB_D/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/10/19/ZT10_3_S/" itemprop="url">
                【正谈10月】Square技术架构
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-10-19T22:45:48+08:00" content="2015-10-19">
            2015-10-19
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>一个由Square搭建的‘OK’框架，将构造一套有效的Android架构开发。</p>
<h2 id="背景">背景</h2><p>2015年4月9日Android界的大神Jake Wharton参加Droidcon MTL 2015大会，在会议上他向Andorid开发者展示了Square公司的一套成熟架构，这套架构他们开源并完善了3年多，演讲的主题也便是我们今天要讨论的核心问题：A Few ‘Ok’ Libraries in Square。</p>
<p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/Image%201111113.png" alt=""><br>(话说J神在Square的伙食是不是越来越好了？呵呵{笑脸}…)</p>
<h2 id="A_Few_‘Ok’_Libraries_in_Square">A Few ‘Ok’ Libraries in Square</h2><p><img src="http://i.imgur.com/C3G1yXh.png" alt=""></p>
<blockquote>
<p>*金字塔塔底由Okio替代并延伸java-io;</p>
<p>*网络数据请求层由Okhttp取代HttpClient和HttpURLConnection;</p>
<p>*Json数据转换层由Moshi替代原生json解析;</p>
<p>*表层代码调用层由Retrofit实现REST-API列表。</p>
</blockquote>
<p>======================<br>|    Name  |  Author  |  Description |<br>|    —   |  —     |  —         |<br>|   <a href="https://github.com/square/okio" target="_blank" rel="external">okio</a>    |    <a href="https://github.com/square" target="_blank" rel="external">square</a>    |    [A modern I/O API for Java]    |<br>|   <a href="https://github.com/square/okhttp" target="_blank" rel="external">okhttp</a>    |    <a href="https://github.com/square" target="_blank" rel="external">square</a>    |    [An HTTP+SPDY client for Android and Java applications]    |   <a href="https://github.com/square/moshi" target="_blank" rel="external">moshi</a>    |    <a href="https://github.com/square" target="_blank" rel="external">square</a>    |    [A modern JSON library for Android and Java]   |   <a href="https://github.com/square/retrofit" target="_blank" rel="external">retrofit2</a>    |    <a href="https://github.com/square" target="_blank" rel="external">square</a>    |    [Type-safe HTTP client for Android and Java by Square]        |</p>
<p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/Image222222%204.png" alt=""></p>
<p>这是整体的架构图,四个部成：</p>
<ul>
<li><p>1.DroidconMtl:这个其实不是组成部分，是J神经常技术交流的一个大会的名称，它是加拿大非常有名的一个Android技术交流大会。称它为Android-I/O大会都不为过。所以实际这里的组成是四个包的封装，然后执行调用网络请求代码，也就是我们的代码层面上的东西。这个层级我会给完整的source-demo和notice-tips。</p>
</li>
<li><p>2.Retrofit:调用Retrofit的异步请求逻辑后，封装的是<t>-pojo对象，向下发送逻辑请求。(架构自身完成代码)</t></p>
</li>
<li><p>3.Moshi层，包含Moshi架构本身，以及和Ohttp关联的MoshiConverter解析器。(架构自身完成代码)</p>
</li>
<li><p>4.OKhttp层，就是网络数据的请求层，将请求通过socket最终发送到服务端。(架构自身完成代码)</p>
</li>
</ul>
<p>This talk will be an in-depth look at Okio—a tiny library for interacting with bytes—and a few of the libraries written on top of it: OkHttp, Retrofit, and a newcomer named Moshi.</p>
<p>Okio evolved naturally inside of OkHttp before being split out into its own library. It wraps common patterns behind a friendly API for reading, writing, and processing data. We’ll start with some fundamentals of the library and how it can enable you to work very close to raw data with ease.</p>
<p>After an introduction to Okio, we will look at three libraries written with it: OkHttp, a modern HTTP client; Retrofit, a high-level HTTP wrapper; and Moshi, a brand new library for serialization.</p>
<p>Not only are these libraries powerful on their own, but when combined their efficiency and performance dramatically increase. We’ll conclude with demonstration of how to use them in your applications to great effect.</p>
<p>J神的开场白，不做太直白翻译了，大体的意思就是：会着重描述Okio这个处理字节的类库(读、写和处理data)，同时会介绍OkHttp和Retrofit，以及新类库Moshi。OkHttp是一个现代的标准HTTP请求客户端，Retrofit是一个高级别的Http包装(REST客服端)，Moshi为序列化(其实就就是JSON解析)。这些库单独使用就很强大(powerful),当他们结合时将更效率(efficiency)和性能(performance)提升(increase)。我们将展示如何在你的应用中用好他们。</p>
<p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/Image%20qqqqqq5.png" alt=""></p>
<p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/Image%20qqqqqq6.png" alt=""></p>
<p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/Image%20qqqqqq7.png" alt=""></p>
<p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/Image%20qqqqqqq8.png" alt=""></p>
<h3 id="一-Okio">一.Okio</h3><p>Okio is a new library that complements java.io and java.nio to make it much easier to access, store, and process your data.</p>
<p><a href="https://github.com/square/okio" title="https://github.com/square/okio" target="_blank" rel="external">https://github.com/square/okio</a></p>
<p>Okio是一个对原有的java.io和java.nio进行改进的IO库，使IO操作更加高效和方便。  </p>
<p>1.对数据进行了分块处理，对大数据效率尤为明显;</p>
<p>2.对数据块使用链表进行管理;</p>
<p>3.对闲置的块进行管理，通过一个块池（SegmentPool）的管理，避免系统GC和申请byte时的zero-fill。</p>
<p>4.它对数据的读取写入进行了封装;</p>
<p>5.超时操作;</p>
<h2 id="ByteStrings_and_Buffers">ByteStrings and Buffers</h2><p>Okio is built around two types that pack a lot of capability into a straightforward API:</p>
<ul>
<li>[<strong>ByteString</strong>][3] is an immutable sequence of bytes. For character data, <code>String</code><br>is fundamental. <code>ByteString</code> is String’s long-lost brother, making it easy to<br>treat binary data as a value. This class is ergonomic: it knows how to encode<br>and decode itself as hex, base64, and UTF-8.</li>
</ul>
<p>ByteString是一个固定大小的byte序列（由一个byte数组构成）。String是Java经常使用到的一个基本类型，ByteString对String进行了封装，为byte和String间的转换和String不同值间的转换（UTF-8编解码，Hex编解码，Base64编解码，ASCIll编解码）提供了十分方便的操作。</p>
<ul>
<li>[<strong>Buffer</strong>][4] is a mutable sequence of bytes. Like <code>ArrayList</code>, you don’t need<br>to size your buffer in advance. You read and write buffers as a queue: write<br>data to the end and read it from the front. There’s no obligation to manage<br>positions, limits, or capacities.</li>
</ul>
<p>Buffer是一个不固定大小的byte序列（由一个节点为Segment的双向循环队列链表构成），它充当Sink、Source、InputStream和OutputStream间的高效缓存区，由于Buffer实现了BufferedSource和BufferedSink这两个接口，所以可以很方便的对其进行IO操作。Buffer在多线程编程里很有用，比如一个负责网络的线程可以通过这种方式和工作线程进行数据交换，但是又不发生数据的复制。</p>
<h2 id="Sources_and_Sinks">Sources and Sinks</h2><p>Okio的流类型：<br>Okio includes its own stream types called Source and Sink that work like InputStream and OutputStream。</p>
<ul>
<li><p>接口[<strong>Sink</strong>]，[<strong>BufferedSink</strong>]<br>Sink和java.io中的OutputStream类似，BufferedSink是一个对Sink进行扩展的接口。使用OutputStream时，在传输不同的数据是需要对OutputStream进行不同的包装，比如用DataOutputStream进行原始数据的IO，用BufferedOutputStream进行带缓存的数据IO，用OutputStreamWriter进行字符编码。对于Sink来说，只需要使用BufferedSink就可以实现以上所有的情况。</p>
</li>
<li><p>接口[<strong>Source</strong>]，[<strong>BufferedSource</strong>]<br>Source和java.io中的InputStream类似，BufferedSource是一个对Source进行扩展的接口。使用InputStream时，在传输不同的数据是需要对InputStream进行不同的包装，比如用DataInputStream进行原始数据的IO，用BufferedInputStream进行带缓存的数据IO，用OutputStreamReader进行字符编码。对于Source来说，只需要使用BufferedSource就可以实现以上所有的情况。</p>
</li>
</ul>
<p>Sources and sinks interoperate with InputStream and OutputStream. You can view any Source as an InputStream, and you can view any InputStream as a Source. Similarly for Sink and OutputStream.</p>
<h2 id="API：">API：</h2><p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/736443Image2222%201.png" alt=""></p>
<p>首先来看如何获取Source、Sink和Buffer、ByteString对象</p>
<p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/736443QQQImage%202.png" alt=""></p>
<pre><code><span class="comment">//Source和java.io中的InputStream类似</span>
<span class="keyword">Source</span> <span class="keyword">source</span> = Okio.<span class="keyword">source</span>(InputStream)；
</code></pre><p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/736443qqqqImage%205.png" alt=""></p>
<pre><code><span class="comment">//BufferedSource是一个对Source进行扩展的接口。</span>
BufferedSource pngSource = Okio.buffer(Okio.<span class="keyword">source</span>(<span class="keyword">in</span>));
</code></pre><p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/736443zzzzmage%209.png" alt=""><br><img src="http://7xn9yd.com1.z0.glb.clouddn.com/736443aaaaImage%207.png" alt=""><br><img src="http://7xn9yd.com1.z0.glb.clouddn.com/736443aaaaImage%206.png" alt=""><br><img src="http://7xn9yd.com1.z0.glb.clouddn.com/736443啊啊啊啊Image%208.png" alt=""></p>
<pre><code><span class="comment">// Each chunk is a length, type, data, and CRC offset.</span>
<span class="keyword">int</span> <span class="built_in">length</span> = pngSource.readInt();
String type = pngSource.readUtf8(<span class="number">4</span>);
pngSource.readFully(chunk, <span class="built_in">length</span>);
<span class="keyword">int</span> crc = pngSource.readInt();
</code></pre><p>一般获取Buffer及读取UTF-8字符串文件再获取为inputStream：<br><img src="http://7xn9yd.com1.z0.glb.clouddn.com/736443额Image%2010.png" alt=""><br><img src="http://7xn9yd.com1.z0.glb.clouddn.com/736443tttttImage%2012.png" alt=""><br><img src="http://7xn9yd.com1.z0.glb.clouddn.com/736443ttttttImage%2011.png" alt=""></p>
<pre><code>SSLSocketFactory sslSocketFactory = SSLUtil.getSSLSocketFactory<span class="params">(new Buffer<span class="params">()</span>.writeUtf8<span class="params">(CERT)</span>.inputStream<span class="params">()</span>)</span>;
client.setSslSocketFactory<span class="params">(sslSocketFactory)</span>;
</code></pre><h2 id="OKIO使用：">OKIO使用：</h2><p>根据PNG文件署名域判断一个图片是否是真实PNG：</p>
<pre><code><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ByteString PNG_HEADER=ByteString.decodeHex(<span class="string">"89504e470d0a1a0a"</span>);

<span class="keyword">public</span> <span class="keyword">boolean</span> isPng(InputStream in) <span class="keyword">throws</span> IOException {
  BufferedSource pngSource = Okio.buffer(Okio.<span class="keyword">source</span>(in));

  ByteString header = pngSource.readByteString(PNG_HEADER.<span class="keyword">size</span>());
  <span class="keyword">if</span> (!header.equals(PNG_HEADER)) {
    <span class="keyword">return</span> <span class="keyword">false</span>;
  }<span class="keyword">else</span>{
    <span class="keyword">return</span> <span class="keyword">true</span>;    
  }

}
</code></pre><h3 id="二-Okhttp">二.Okhttp</h3><h3 id="三-Moshi">三.Moshi</h3><h3 id="四-Retrofit">四.Retrofit</h3><p>Retrofit现在分两个版本，一个是2.0前版本，比如1.9-，还有一个就是升级的Retrofit2。Retrofit2内部的核心代码都重新架构过,最主要的是直接支持了更多的json解析框架，API调用虽然有小变化，但整体变化不大。</p>
<p>所以我现在这里的介绍的就是最新的Retrofit2的内容，因为1.9或1.9-将渐渐成为历史。</p>
<h4 id="retrofit完成请求">retrofit完成请求</h4><p>1.Application中初始化创建Retrofit实例：</p>
<pre><code><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SnakeService</span> </span>{
    <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>{
        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SnakeService <span class="title">create</span><span class="params">()</span> </span>{
            Retrofit retrofit = <span class="keyword">new</span> Retrofit.Builder()
                    .baseUrl(<span class="string">"http://www.xxxxx.com/v6/"</span>)                      
                    .addConverterFactory(MoshiConverterFactory.create())
                    .build();
            <span class="keyword">return</span> retrofit.create(SnakeService.class);
        }
    }
}

<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApplication</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>{

    <span class="keyword">private</span> SnakeService snakeService;

    <span class="annotation">@Override</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>{
        <span class="keyword">super</span>.onCreate();
        initService();
    }


    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initService</span><span class="params">()</span> </span>{
        <span class="keyword">this</span>.snakeService = SnakeService.Factory.create();
    }

    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MyApplication <span class="title">get</span><span class="params">(Context context)</span> </span>{
        <span class="keyword">return</span> (MyApplication) context.getApplicationContext();
    }

    <span class="function"><span class="keyword">public</span> SnakeService <span class="title">getSnakeService</span><span class="params">()</span> </span>{
        <span class="keyword">if</span>(snakeService==<span class="keyword">null</span>){
             snakeService=SnakeService.Factory.create();
        }
        <span class="keyword">return</span> snakeService;
    }
}
</code></pre><p>2.定义接口</p>
<pre><code><span class="variable">@POST</span>(<span class="string">"tehui/getTehuiByJigouId"</span>)
Call&lt;JsonFather&gt; <span class="function">loadData</span>(<span class="variable">@QueryMap</span> Map&lt;String, String&gt; map);


<span class="variable">@POST</span>(<span class="string">"tehui/getTehuiByJigouId"</span>)
Call&lt;ResponseBody&gt; <span class="function">loadData2</span>(<span class="variable">@QueryMap</span> Map&lt;String, String&gt; map);
</code></pre><p>3.根据返回的json串创建json-bean对象</p>
<p>这是我服务器返回的Json:</p>
<pre><code>{
    "<span class="attribute">state</span>": <span class="value"><span class="string">"000"</span></span>,
    "<span class="attribute">t_rs</span>": <span class="value">[
        {
            "<span class="attribute">id</span>": <span class="value"><span class="string">"1422"</span></span>,
            "<span class="attribute">title</span>": <span class="value"><span class="string">"[ 上海万安 ]360艺术美鼻"</span></span>,
            "<span class="attribute">image</span>": <span class="value"><span class="string">"http://tehui.meilimei.com/static/team/2015/0612/14340889238311.jpg?201510201128"</span></span>,
            "<span class="attribute">team_price</span>": <span class="value"><span class="string">"500.00"</span></span>,
            "<span class="attribute">now_number</span>": <span class="value"><span class="string">"1"</span></span>,
            "<span class="attribute">market_price</span>": <span class="value"><span class="string">"22800.00"</span></span>,
            "<span class="attribute">delivery</span>": <span class="value"><span class="string">"coupon"</span></span>,
            "<span class="attribute">deposit</span>": <span class="value"><span class="string">"500.00"</span></span>,
            "<span class="attribute">mechanism</span>": <span class="value"><span class="string">"上海万安医疗美容医院"</span></span>,
            "<span class="attribute">flag</span>": <span class="value"><span class="number">1</span>
        </span>},
        {
            "<span class="attribute">id</span>": <span class="value"><span class="string">"1602"</span></span>,
            "<span class="attribute">title</span>": <span class="value"><span class="string">"[ 上海万安 ]瑞兰玻尿酸注射 不开刀就能美美哒的秘密"</span></span>,
            "<span class="attribute">image</span>": <span class="value"><span class="string">"http://tehui.meilimei.com/static/team/2015/0624/14351340349342.jpg?201510201128"</span></span>,
            "<span class="attribute">team_price</span>": <span class="value"><span class="string">"300.00"</span></span>,
            "<span class="attribute">now_number</span>": <span class="value"><span class="string">"4"</span></span>,
            "<span class="attribute">market_price</span>": <span class="value"><span class="string">"3800.00"</span></span>,
            "<span class="attribute">delivery</span>": <span class="value"><span class="string">"coupon"</span></span>,
            "<span class="attribute">deposit</span>": <span class="value"><span class="string">"300.00"</span></span>,
            "<span class="attribute">mechanism</span>": <span class="value"><span class="string">"上海万安医疗美容医院"</span></span>,
            "<span class="attribute">flag</span>": <span class="value"><span class="number">1</span>
        </span>},
        {
            "<span class="attribute">id</span>": <span class="value"><span class="string">"1603"</span></span>,
            "<span class="attribute">title</span>": <span class="value"><span class="string">"[ 上海万安 ]韩式半永久定妆"</span></span>,
            "<span class="attribute">image</span>": <span class="value"><span class="string">"http://tehui.meilimei.com/static/team/2015/0624/14351340357063.jpg?201510201128"</span></span>,
            "<span class="attribute">team_price</span>": <span class="value"><span class="string">"100.00"</span></span>,
            "<span class="attribute">now_number</span>": <span class="value"><span class="string">"8"</span></span>,
            "<span class="attribute">market_price</span>": <span class="value"><span class="string">"3800.00"</span></span>,
            "<span class="attribute">delivery</span>": <span class="value"><span class="string">"coupon"</span></span>,
            "<span class="attribute">deposit</span>": <span class="value"><span class="string">"100.00"</span></span>,
            "<span class="attribute">mechanism</span>": <span class="value"><span class="string">"上海万安医疗美容医院"</span></span>,
            "<span class="attribute">flag</span>": <span class="value"><span class="number">1</span>
        </span>}
    ]
</span>}
</code></pre><p>注：<a href="http://www.jsonschema2pojo.org/" target="_blank" rel="external">http://www.jsonschema2pojo.org/</a>   使用它将方便的帮助你将json转成pojo代码。</p>
<p>json-bean:</p>
<pre><code>public class JsonFather extends BaseInfoBen{

    private String <span class="keyword">state</span>;

    private String notice;

    public String getNotice() {
        return notice;
    }

    public void <span class="built_in">set</span>Notice(String notice) {
        this.notice = notice;
    }

    private List<span class="variable">&lt;NewHuiListInfo&gt;</span> t_rs = new ArrayList<span class="variable">&lt;NewHuiListInfo&gt;</span>();


    public String getState() {
        return <span class="keyword">state</span>;
    }

    public List<span class="variable">&lt;NewHuiListInfo&gt;</span> getT_rs() {
        return t_rs;
    }

    public void <span class="built_in">set</span>T_rs(List<span class="variable">&lt;NewHuiListInfo&gt;</span> t_rs) {
        this.t_rs = t_rs;
    }

    public void <span class="built_in">set</span>State(String <span class="keyword">state</span>) {
        this.<span class="keyword">state</span> = <span class="keyword">state</span>;
    }

}
</code></pre><p>4.异步调用</p>
<pre><code><span class="keyword">private</span> <span class="keyword">void</span> getData() {

    <span class="keyword">final</span> <span class="keyword">HashMap</span>&lt;<span class="keyword">String</span>, <span class="keyword">String</span>&gt; <span class="built_in">map</span> = <span class="keyword">new</span> <span class="keyword">HashMap</span>&lt;&gt;();
    <span class="built_in">map</span>.put(<span class="string">"jigou_id"</span>, <span class="string">"372759"</span>);
    <span class="built_in">map</span>.put(<span class="string">"page"</span>, <span class="string">"1"</span>);
    <span class="built_in">map</span>.put(<span class="string">"signapp"</span>, MD5);

    Call&lt;JsonFather&gt; listCall = MyApplication.<span class="built_in">get</span>(context).getSnakeService().loadData(Collections.unmodifiableMap(<span class="built_in">map</span>));

    listCall.enqueue(<span class="keyword">new</span> Callback&lt;JsonFather&gt;() {



        <span class="comment">//main thread</span>
        @Override
        <span class="keyword">public</span> <span class="keyword">void</span> onResponse(Response&lt;JsonFather&gt; response, Retrofit retrofit) {
            JsonFather body = response.body();
            List&lt;NewHuiListInfo&gt; t_rs = body.getT_rs();
            <span class="keyword">if</span>(<span class="keyword">null</span>==body){
                Toast.makeText(context, <span class="string">"null"</span>, Toast.LENGTH_LONG).show();
            }<span class="keyword">else</span>{
                tvText.setText(t_rs.<span class="built_in">get</span>(<span class="number">0</span>).getImage());
            }              
        }

        <span class="comment">//main thread</span>
        @Override
        <span class="keyword">public</span> <span class="keyword">void</span> onFailure(Throwable throwable) {
            Toast.makeText(context, <span class="string">"onFailure:"</span>+throwable.toString(), Toast.LENGTH_LONG).show();
        }
    });

}
</code></pre><h4 id="核心Tips">核心Tips</h4><p>Tips1.如何添加@GET\@POST请求的参数：</p>
<pre><code>使用<span class="variable">@QueryMap</span>   或者  <span class="variable">@Query</span>
</code></pre><p>Tips2.如何定义 Endpoints</p>
<p>@Path用于url地址上可变的参数量</p>
<pre><code><span class="variable">@GET</span>(<span class="string">"/users/{username}"</span>)
Call&lt;User&gt; <span class="function">getUser</span>(<span class="variable">@Path</span>(<span class="string">"username"</span>) String username);
</code></pre><p>@Query用于一个请求参数   @QueryMap用于封装成map的请求参数组</p>
<pre><code><span class="variable">@GET</span>(<span class="string">"bestof"</span>)
Observable&lt;Feed&gt; <span class="function">bestof</span>(<span class="variable">@Query</span>(<span class="string">"tags"</span>) String tags,
                        <span class="variable">@Query</span>(<span class="string">"user"</span>) String user,
                        <span class="variable">@Query</span>(<span class="string">"flags"</span>) int flags,
                        <span class="variable">@Query</span>(<span class="string">"older"</span>) Long older,
                        <span class="variable">@Query</span>(<span class="string">"score"</span>) int benisScore);

<span class="variable">@GET</span>(<span class="string">"/group/{id}/users"</span>)
Call&lt;List&lt;User&gt;&gt; <span class="function">groupList</span>(<span class="variable">@Path</span>(<span class="string">"id"</span>) int groupId, <span class="variable">@Query</span>(<span class="string">"sort"</span>) String sort);

<span class="variable">@POST</span>(<span class="string">"tehui/getTehuiByJigouId"</span>)
Call&lt;JsonFather&gt; <span class="function">loadData</span>(<span class="variable">@QueryMap</span> Map&lt;String, String&gt; map);
</code></pre><p>调用：</p>
<pre><code><span class="keyword">final</span> <span class="keyword">HashMap</span>&lt;<span class="keyword">String</span>, <span class="keyword">String</span>&gt; <span class="built_in">map</span> = <span class="keyword">new</span> <span class="keyword">HashMap</span>&lt;&gt;();
<span class="built_in">map</span>.put(<span class="string">"jigou_id"</span>, <span class="string">"372759"</span>);
<span class="built_in">map</span>.put(<span class="string">"page"</span>, <span class="string">"1"</span>);
<span class="built_in">map</span>.put(<span class="string">"signapp"</span>, MD5);

Call&lt;JsonFather&gt; listCall = MyApplication.<span class="built_in">get</span>(context).getSnakeService().loadData(Collections.unmodifiableMap(<span class="built_in">map</span>));
</code></pre><p>@Headers 请求头信息</p>
<pre><code><span class="variable">@Headers</span>(<span class="string">"Accept: application/json"</span>)
<span class="variable">@HEAD</span>(<span class="string">"/recurso/cultura-ocio/evento-zaragoza?rf=html&amp;results_only=false&amp;srsname=wgs84&amp;rows=1000&amp;q=programa%3D%3Dfiestas%20del%20pilar"</span>)
public void <span class="function">getHeaders</span>(Callback&lt;retrofit.client.Header&gt; callback);
</code></pre><p>@Body 可以声明一个对象作为请求体发送到服务器</p>
<pre><code> <span class="variable">@POST</span>(<span class="string">"/users/new"</span>)
Call&lt;User&gt; <span class="function">createUser</span>(<span class="variable">@Body</span> User user);
</code></pre><p>User对象将被对应的转换器转换为字符串或者字节流提交到服务器。</p>
<p>@FormUrlEncoded 注解来发送表单数据。使用 @Field注解和参数来指定每个表单项的Key，value为参数的值。</p>
<pre><code><span class="variable">@FormUrlEncoded</span>
<span class="variable">@POST</span>(<span class="string">"/user/edit"</span>)
User <span class="function">updateUser</span>(<span class="variable">@Field</span>(<span class="string">"first_name"</span>) String first, <span class="variable">@Field</span>(<span class="string">"last_name"</span>) String last);
</code></pre><p>@Multipart 注解来发送multipart数据(文件上传)。使用 @Part 注解定义要发送的每个文件。</p>
<pre><code><span class="variable">@Multipart</span>
<span class="variable">@PUT</span>(<span class="string">"/user/photo"</span>)
User <span class="function">updateUser</span>(<span class="variable">@Part</span>(<span class="string">"photo"</span>) TypedFile photo, <span class="variable">@Part</span>(<span class="string">"description"</span>) TypedString description);
</code></pre><p>Tips3.Retrofit为什么不需要你关注json格式？</p>
<pre><code>因为实体bean对象其实就代表了json的格式
</code></pre><p>Tips4.如何使用retrofit标识同步和异步：</p>
<p>2.0版本同步：execute()</p>
<pre><code><span class="operator"><span class="keyword">Call</span>&lt;Repo&gt; <span class="keyword">call</span> = service.loadRepo();</span>
Repo repo = <span class="operator"><span class="keyword">call</span>.<span class="keyword">execute</span>();</span>
</code></pre><p>2.0版本异步：enqueue()</p>
<pre><code><span class="operator"><span class="keyword">Call</span>&lt;Repo&gt; <span class="keyword">call</span> = service.loadRepo();</span>
<span class="operator"><span class="keyword">call</span>.<span class="keyword">enqueue</span>(<span class="keyword">new</span> Callback&lt;Repo&gt;() {
    @Override
    <span class="keyword">public</span> <span class="built_in">void</span> onResponse(Response&lt;Repo&gt; response) {
        // <span class="keyword">Get</span> <span class="keyword">result</span> Repo <span class="keyword">from</span> response.<span class="keyword">body</span>()
    }

    @Override
    <span class="keyword">public</span> <span class="built_in">void</span> onFailure(Throwable <span class="keyword">t</span>) {

    }
});</span>
</code></pre><p>Tips5.我该如何只想返回json串，自己去做解析</p>
<p>见issiue：</p>
<p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/强强强强Image%204.png" alt=""></p>
<p>代码：</p>
<pre><code> @POST<span class="params">(<span class="string">"tehui/getTehuiByJigouId"</span>)</span>
Call&lt;ResponseBody&gt; loadData2<span class="params">(@QueryMap Map&lt;String, String&gt; map)</span>;

Call&lt;ResponseBody&gt; listCall2 = MyApplication.get<span class="params">(context)</span>.getSnakeService<span class="params">()</span>.loadData2<span class="params">(Collections.unmodifiableMap<span class="params">(map)</span>)</span>;


listCall2.enqueue<span class="params">(new Callback&lt;ResponseBody&gt;<span class="params">()</span> {
        @Override
        public void onResponse<span class="params">(Response&lt;ResponseBody&gt; response, Retrofit retrofit)</span> {

            //<span class="number">1</span>.先判断是否是<span class="number">200</span>或者<span class="number">201</span>请求成功
            if<span class="params">(response.isSuccess<span class="params">()</span>)</span>{
                // request successful <span class="params">(status code <span class="number">200</span>, <span class="number">201</span>)</span>

                //<span class="number">2</span>.处理是否为null response.body<span class="params">()</span>会返回null
                if<span class="params">(null!=response.body<span class="params">()</span>)</span>{
                    try {
                        tvText.setText<span class="params">(response.body<span class="params">()</span>.string<span class="params">()</span>)</span>;
                    } catch <span class="params">(IOException e)</span> {
                        e.printStackTrace<span class="params">()</span>;
                        tvText.setText<span class="params">(<span class="string">"IOException"</span>)</span>;
                    }
                }
            }else{

                //request not successful <span class="params">(like <span class="number">400</span>,<span class="number">401</span>,<span class="number">403</span> etc)</span>
                //Handle errors

                if<span class="params">(null!=response.errorBody<span class="params">()</span>)</span>{
                    try {
                        tvText.setText<span class="params">(response.errorBody<span class="params">()</span>.string<span class="params">()</span>)</span>;
                    } catch <span class="params">(IOException e)</span> {
                        e.printStackTrace<span class="params">()</span>;
                        tvText.setText<span class="params">(<span class="string">"IOException"</span>)</span>;
                    }
                }


            }



        }

        @Override
        public void onFailure<span class="params">(Throwable throwable)</span> {

        }
 })</span>;
</code></pre><p>注意2.0前的版本如果想返回的是json串使用的是：Response (2.0是ResponseBody)。</p>
<p>Tips6.如何定义URL是最好的书写习惯：</p>
<p>建议：</p>
<ul>
<li>Base URL: 总是以 /结尾</li>
<li>@Url: 不要以 / 开头</li>
</ul>
<p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/rrrImage%205.png" alt=""></p>
<p>最终拼凑成：<a href="http://www.xxxxxx.com/v6/tehui/getTehuiByJigouId" target="_blank" rel="external">http://www.xxxxxx.com/v6/tehui/getTehuiByJigouId</a></p>
<p>Tips7.如何定义json解析工具：</p>
<p><img src="http://7xn9yd.com1.z0.glb.clouddn.com/dddddddImage%206.png" alt=""></p>
<pre><code>Retrofit retrofit = new Retrofit.Builder<span class="params">()</span>
               .baseUrl<span class="params">(<span class="string">"http://www.xxxxxx.com/v6/"</span>)</span>  
               <span class="comment">//指定为moshi解析json                 </span>
               .addConverterFactory<span class="params">(MoshiConverterFactory.create<span class="params">()</span>)</span>                    
               .build<span class="params">()</span>;
       return retrofit.create<span class="params">(SnakeService.class)</span>;
</code></pre><p>Tips8.如何配合使用RxJava：</p>
<p>Retrofit团队有已经准备好了的CallAdapter module。其中最著名的module可能是为RxJava准备的CallAdapter，它将作为Observable返回。</p>
<pre><code><span class="keyword">compile</span> <span class="string">'com.squareup.retrofit:adapter-rxjava:2.0.0-beta1'</span>
<span class="keyword">compile</span> <span class="string">'io.reactivex:rxandroid:1.0.1'</span>
</code></pre><p>Sync Gradle并在Retrofit Builder链表中如下调用addCallAdapterFactory：</p>
<pre><code>Retrofit retrofit = new Retrofit.Builder<span class="params">()</span>
    .baseUrl<span class="params">(<span class="string">"http://api.nuuneoi.com/base/"</span>)</span>
    .addConverterFactory<span class="params">(GsonConverterFactory.create<span class="params">()</span>)</span>
    .addCallAdapterFactory<span class="params">(RxJavaCallAdapterFactory.create<span class="params">()</span>)</span>
    .build<span class="params">()</span>;



Observable&lt;DessertItemCollectionDao&gt; observable = service.loadDessertListRx<span class="params">()</span>;

observable.observeOn<span class="params">(AndroidSchedulers.mainThread<span class="params">()</span>)</span>
    .subscribe<span class="params">(new Subscriber&lt;DessertItemCollectionDao&gt;<span class="params">()</span> {
        @Override
        public void onCompleted<span class="params">()</span> {
            Toast.makeText<span class="params">(getApplicationContext<span class="params">()</span>,
                    <span class="string">"Completed"</span>,
                    Toast.LENGTH_SHORT)</span>
                .show<span class="params">()</span>;
        }

        @Override
        public void onError<span class="params">(Throwable e)</span> {
            Toast.makeText<span class="params">(getApplicationContext<span class="params">()</span>,
                    e.getMessage<span class="params">()</span>,
                    Toast.LENGTH_SHORT)</span>
                .show<span class="params">()</span>;
        }

        @Override
        public void onNext<span class="params">(DessertItemCollectionDao dessertItemCollectionDao)</span> {
            Toast.makeText<span class="params">(getApplicationContext<span class="params">()</span>,
                    dessertItemCollectionDao.getData<span class="params">()</span>.get<span class="params">(<span class="number">0</span>)</span>.getName<span class="params">()</span>,
                    Toast.LENGTH_SHORT)</span>
                .show<span class="params">()</span>;
        }
    })</span>;
</code></pre><p>Tips9.onResponse()方法如何健壮性的处理</p>
<p>在2.0版本，首先不管 response 是否能被解析。onResponse()总是会被调用。但是在结果不能被解析的情况下，response.body()会返回null。</p>
<p>其次：onResponse()和onFailure()都是在主线程运行的。</p>
<pre><code>a.先判断HTTP状态码（HTTP Status Code） 是否为<span class="number">200</span>/<span class="number">201</span>
b.再判断<span class="keyword">body</span>是否为<span class="literal">null</span>
c.数组的size是否为<span class="number">0</span>,如果为<span class="number">0</span>要注意避免<span class="literal">null</span>指针异常或更新为无数据界面.


listCall.enqueue(<span class="keyword">new</span> Callback&lt;ResponseBody&gt;() {
        <span class="keyword">@Override</span>
        <span class="keyword">public</span> <span class="keyword">void</span> onResponse(Response&lt;ResponseBody&gt; response, Retrofit retrofit) {

            <span class="comment">//1.先判断是否是200或者201请求成功</span>
            <span class="keyword">if</span>(response.isSuccess()){
                <span class="comment">// request successful (status code 200, 201)</span>

                <span class="comment">//2.处理是否为null response.body()会返回null</span>
                <span class="keyword">if</span>(<span class="literal">null</span>!=response.<span class="keyword">body</span>()){
                    <span class="keyword">try</span> {
                        <span class="comment">//3.size大小</span>
                        <span class="keyword">if</span>(response.<span class="keyword">body</span>().getArray().size &gt; <span class="number">0</span>){
                             tvText.setText(response.<span class="keyword">body</span>().<span class="built_in">string</span>());
                        }
                    } <span class="keyword">catch</span> (IOException e) {
                        e.printStackTrace();
                        tvText.setText(<span class="string">"IOException"</span>);
                    }
                }
            }<span class="keyword">else</span>{

                <span class="comment">//request not successful (like 400,401,403 etc)--Handle errors</span>

                <span class="keyword">if</span>(<span class="literal">null</span>!=response.errorBody()){
                    <span class="keyword">try</span> {
                        tvText.setText(response.errorBody().<span class="built_in">string</span>());
                    } <span class="keyword">catch</span> (IOException e) {
                        e.printStackTrace();
                        tvText.setText(<span class="string">"IOException"</span>);
                    }
                }


            }



        }

        <span class="keyword">@Override</span>
        <span class="keyword">public</span> <span class="keyword">void</span> onFailure(Throwable throwable) {

        }
    });
</code></pre><p>Tips10.onPreExecute()和onPostExecute的加载loading怎么展示比较好：</p>
<p>将开始加载放在listCall.enqueue之前调用(伪代码):</p>
<pre><code>onStartLoading<span class="params">()</span>
listCall.enqueue<span class="params">(Callback)</span>;
</code></pre><p>将关闭加载放在的回调函数onResponse和onFailure的最开始处理(伪代码)：</p>
<pre><code>onStartLoading<span class="literal">()</span>;
listCall.enqueue(<span class="keyword">new</span> <span class="type">Callback</span><span class="literal">()</span>{
    onResponse<span class="literal">()</span>{
        onStopLoading<span class="literal">()</span>;
    }
    onFailure<span class="literal">()</span>{
        onStopLoading<span class="literal">()</span>;
    }
});
</code></pre><p>Tips11.为什么我网络成功，但返回的array数组里什么都没有,是:[]，moshi究竟需要怎样的格式才可以完成自我json转化为pojo对象：</p>
<pre><code>{
    "<span class="attribute">state</span>": <span class="value"><span class="string">"000"</span></span>,
    "<span class="attribute">t_rs</span>": <span class="value">[
        {
            "<span class="attribute">id</span>": <span class="value"><span class="string">"1422"</span></span>,
            "<span class="attribute">title</span>": <span class="value"><span class="string">"[ 上海万安 ]360艺术美鼻"</span></span>,
            "<span class="attribute">image</span>": <span class="value"><span class="string">"http://tehui.meilimei.com/static/team/2015/0612/14340889238311.jpg?201510200800"</span></span>,
            "<span class="attribute">team_price</span>": <span class="value"><span class="string">"500.00"</span></span>,
            "<span class="attribute">now_number</span>": <span class="value"><span class="string">"1"</span></span>,
            "<span class="attribute">market_price</span>": <span class="value"><span class="string">"22800.00"</span></span>,
            "<span class="attribute">delivery</span>": <span class="value"><span class="string">"coupon"</span></span>,
            "<span class="attribute">deposit</span>": <span class="value"><span class="string">"500.00"</span></span>,
            "<span class="attribute">mechanism</span>": <span class="value"><span class="string">"上海万安医疗美容医院"</span></span>,
            "<span class="attribute">flag</span>": <span class="value"><span class="number">1</span>
        </span>},
        {
            "<span class="attribute">id</span>": <span class="value"><span class="string">"1602"</span></span>,
            "<span class="attribute">title</span>": <span class="value"><span class="string">"[ 上海万安 ]瑞兰玻尿酸注射 不开刀就能美美哒的秘密"</span></span>,
            "<span class="attribute">image</span>": <span class="value"><span class="string">"http://tehui.meilimei.com/static/team/2015/0624/14351340349342.jpg?201510200800"</span></span>,
            "<span class="attribute">team_price</span>": <span class="value"><span class="string">"300.00"</span></span>,
            "<span class="attribute">now_number</span>": <span class="value"><span class="string">"4"</span></span>,
            "<span class="attribute">market_price</span>": <span class="value"><span class="string">"3800.00"</span></span>,
            "<span class="attribute">delivery</span>": <span class="value"><span class="string">"coupon"</span></span>,
            "<span class="attribute">deposit</span>": <span class="value"><span class="string">"300.00"</span></span>,
            "<span class="attribute">mechanism</span>": <span class="value"><span class="string">"上海万安医疗美容医院"</span></span>,
            "<span class="attribute">flag</span>": <span class="value"><span class="number">1</span>
        </span>}
    ]
</span>}
</code></pre><p>看这里的json串，数组的key为t_rs，所以</p>
<pre><code>public <span class="class"><span class="keyword">class</span> <span class="title">JsonFather</span> <span class="keyword"><span class="keyword">extends</span></span> <span class="title">BaseInfoBen</span> {</span>

    <span class="keyword">private</span> <span class="type">String</span> state;

    <span class="keyword">private</span> <span class="type">String</span> notice;

    <span class="comment">//这里的这个单词必需和json串对应，否则无法解析成功</span>
    <span class="keyword">private</span> <span class="type">List</span>&lt;<span class="type">NewHuiListInfo</span>&gt; t_rs = <span class="keyword">new</span> <span class="type">ArrayList</span>&lt;&gt;();

}
</code></pre><p>如果一旦你自定义为比如info：</p>
<pre><code><span class="keyword">private</span> <span class="built_in">List</span>&lt;NewHuiListInfo&gt; info = <span class="literal">new</span> ArrayList&lt;&gt;();
</code></pre><p>那你拿回来的info里面就是空数组，可见暂时和gson不同的moshi是根据变量名单词匹配的。gson的解析是根据注解上的名称value来匹配json串的，moshi因为是新框架，暂时不支持注解对应json名，所以它要求你的变量名和json串相同！</p>
<p>不知J神的moshi解析框架以后是否支持注解…待观察…</p>
<h3 id="五-当SquareFoundation遇到MVP和hibernate,将擦出怎样的火花">五.当SquareFoundation遇到MVP和hibernate,将擦出怎样的火花</h3><p>该部分我会封装一套基于’Ok’ Libraries ，结合MVP分层结构，同时使用hibernate思想操作封装对象的框架。届时请关注我博客的更新。</p>
<h3 id="六-结尾语">六.结尾语</h3><p>&emsp;&emsp;1.大神就是大神，一整个核心架构在台座上昭然若现，极度优良的API和接口调用，极富效率的底层架构，都将让我们一窥Square公司的核心开发技巧和能量。这是中国国内狭隘自私不懂开源的BAT这样的公司不能比拟的;</p>
<p>&emsp;&emsp;2.Square即将上市，最新的消息，估计为60亿美金。10月15日我便在微信朋友圈发布了这条消息：</p>
<p>News : <a href="http://3g.163.com/ntes/special/0034073A/wechat_article.html?docid=B5UQKU57000915BF&amp;spst=0&amp;spss=newsapp&amp;spsf=wx&amp;spsw=1" title="Square IPO欲融资2.75亿美元" target="_blank" rel="external">Square IPO欲融资2.75亿美元</a></p>
<p>&emsp;&emsp;并留下了下面的一段话：</p>
<blockquote>
<p>分享这条消息是因为这家公司是Android开源界的大神，自从这家公司09年成立，就一直专职在社区为Android提供新的技术和架构，而如今很多技术都成为Android开发前沿。这家公司的创始人杰克多西也是Twitter的创始人，但由于Twitter的权利内斗而被自己公司fired。如今糟糕营收和缓慢用户增长的Twitter不得不重新请回自家创始人。多西8岁开始在自己的第一台IBM电脑上学习编程，是个不折不扣的屌丝程序猿，但好在国外优良的创业传统，给予很多有想法的程序猿改变世界以及自己，国外牛逼的互联网公司的创始人都是程序猿。反观国内程序猿如屌丝般的我们，天天奔波在2点1线，每个月为万把块钱的薪酬奋斗，一套房，一辆车，在国内剥削经济和加班风潮下，早已磨灭斗志和创业意识。</p>
</blockquote>
<p>&emsp;&emsp;后来又翻到了一篇2013年年底的新闻：</p>
<p>News : <a href="http://3g.163.com/ntes/special/0034073A/wechat_article.html?docid=9GKN0NE600964KJ3&amp;spst=0&amp;spss=newsapp&amp;spsf=wx&amp;spsw=1" title="太大方了，杰克·多西返还 10% Square 股票" target="_blank" rel="external">太大方了，杰克·多西返还 10% Square 股票</a></p>
<p>&emsp;&emsp;不知道在中国有多少公司能有财富共享的思想，真的很难……你能富有，只是因为你有一帮让你富有的员工。你不写一行代码，你不画一张设计图，你不开发一个客户，你不为一次决策失误买单，你凭什么不珍惜员工。马云说要做一家102年的企业，他指的是已经成立了16年的阿里巴巴…中国国内的互联网环境一直很糟糕，过度的垄断、对技术的敷衍和钱绝不都没有效益领域的偏见思想，导致中国只是一个大局域网的环境，与国外的技术良性发展非常不同。现如今，互联网资本寒冬将至，希望可以戳破这一波非理性型泡沫，留下可以发展的良心企业。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/10/07/ZT10_2/" itemprop="url">
                【正谈10月】框架的规范（一）
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-10-07T21:01:48+08:00" content="2015-10-07">
            2015-10-07
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>框架的规范</p>
<pre><code>/<span class="keyword">*</span><span class="keyword">*</span>
 <span class="keyword">*</span> Created by xiongwei &amp; lele,An Android project Engineer.
 <span class="keyword">*</span> Date:2015-08-14  12:27
 <span class="keyword">*</span> Base on Meilimei.com (PHP Service)
 <span class="keyword">*</span> Describe:   FrescoManager.getInstance().load(url).into(imageview);
 <span class="keyword">*</span> Version:1.0
 <span class="keyword">*</span> Open source
 <span class="keyword">*</span>/
</code></pre><h2 id="前言">前言</h2><p><img src="http://i.imgur.com/gssxZrg.png" alt=""></p>
<p>&emsp;&emsp;2个月前，我和我的同事赵小(亦)乐童鞋在公司决策者的支持下决定彻底放弃Eclipse版本的美丽神器，准备开始着手搭建基于Android studio的Android基础开发框架。在这之前我们的旧版本美丽神器我们开发了整整一年多，但却一直都是松散的架构体系，性能极度低下。我和赵小乐童鞋都是各自为核心构建各自喜欢的架构和开发模块，导致我们会经常将一个模型工具类按照我们自己的思路反复构建两次。而这次我们决定结束这样松散的架构体系，共同启用一套共同搭建的Android开发框架。这套框架要彼此适合我们各自的使用习惯且应该具有极高的规范性、拓展性和可复制型。一年的共同合作让我们拥有了很好的默契和一致认可的开发习惯，这为这套框架的开发提供了坚实的基础和合作默契。也是时候公开我们探究的一些核心元素了。</p>
<p>&emsp;&emsp;Android的框架一直在被不断的探索和发觉，基于“基础Android传统的模式”，“MVP模式”或者“MVVP模式”不断的成为争论的观点。在探究最初新架构时我本意推行MVP的架构模式，但考虑强行推行MVP将导致原有的代码基本需要重写，复用部分将非常少。这将导致我们很难在11月底推出基于MD风格的美丽神器Android端。而MVVP则目前因为data-binding尚不能友好的支持向下兼容，且单向绑定表明Google还有很大的潜力将其转变为双向绑定(开源社区的library早已双向绑定许久)，而此后的代码模块，将导致双向绑定推出后，又要动用时间资源成本重新编排Xml和代码模块。因此均不是最佳选项。</p>
<p>&emsp;&emsp;如果我们一直纠结于使用那种The Clean Architecture架构作为基础时，不妨回到一些很显著的事实上来：其实谷歌官方一直以来没有使用MVP或者MVVP架构，就是考虑到核心模块的过大改动，将使得之前所做的很多成熟模式均带来转变的成本冗余，谷歌官方也需要更多的时间来架构新的java表层框架。我们最终决定保守的处理这次架构的选择，仍然决定使用Android传统的模式。因此依托于当前成熟的Library将成为关键，即便如此，我们也要将许多的核心模块封装成套，在纯Activity(Fragment/View)界面将“节俭化”为最小最少代码。</p>
<p>&emsp;&emsp;彻底开源这套框架，将使得我面临“泄露公司资源”的道德风险，而曲线救国般的展示只言片语的思维核心，将有助于避免这种道德上的风险。因此我们不会开源这套框架，而我将展示我们是如何将一个千万级别下载百万用户的APP，如何完成从Eclipse转到Android studio，从SVN转向Git，同时完成一套核心框架的开发，以及践行MD风格设计的过程，我想这才是最重要的部分，难道“思想”不比“愚钝的代码”更重要吗？！</p>
<p>&emsp;&emsp;这里将是第一部节，这部分将描述框架的规范。我将保障全部文章将不少于10篇，并保证自己一定倾囊相授核心思想，并在开源思想和保守公司资源中做出道德平衡。</p>
<h2 id="框架规范：命名">框架规范：命名</h2><p>&emsp;&emsp;一套优秀的框架最开始并不是要去抉择选用何种library库，不是要实现那种架构模式，也不应该是直接上手分包搭建框架。它应该是一套基础的框架规范命名。这将能够使得多人协作时大家能够彼此按照一个基础的约定来攥写代码，而这种代码必须在命名上就是可以维护且可以被一眼识别的。</p>
<p>&emsp;&emsp;在旧版本美丽神器中，我和赵小乐童鞋就吃了很多的亏，我们直接上手代码，直接攥写xml文件，彼此没有足够的约定俗成，而核心注释的缺失也加重了我们彼此交流的时间成本。不过好在一直以来我们分工明确，产品模块清晰，因此也没有造成太大的障碍。而这次为了避免这样的情况出现。我们专门在一次内部技术沟通会议时花了一下午确定了这一套约束体系。</p>
<p>&emsp;&emsp;也许你会问，直接按照google官方的那些sample命名或者随便找篇网上人写的android命名规范去准守不就行。这里也是我特殊要站出来说明的问题，首先，纸上得来终是浅。其次，不是所有的规范都可以随意套用，不根据自己项目的实际，不根据彼此程序员开发习惯就这样照搬，终不是适合自己的。最后，规范也是人自己定义的，没有人说这个就是正确的，那个就一定是错的。对于一个程序员来说保持自己的思想和正确习惯比准守纸上理论更重要。</p>
<h3 id="一-xml命名">一.xml命名</h3><h4 id="1-_Layout布局的命名">1. Layout布局的命名</h4><p>我们将布局的命名定义为3个结构名+1个补充名</p>
<pre><code>形态名_模块名_布局名<span class="comment">(_补充名...)</span>
</code></pre><hr>
<p>所谓形态名是指layout布局是属于那种界面形态表现，它取值于下面的4个值中</p>
<pre><code><span class="title">activity</span>    fragment     view      util      
</code></pre><p>我们认为形态名越少越好，所以当我给出这四个取值时，你其实就明白了这里的形态究竟含义如何。一个界面，我们可以用activity实现，也可以用fragment实现，也可以是一个直接的view，同时增加一个util作为其他类型的补充，它将专门来表示include界面或者一些可复用的基础界面。</p>
<hr>
<p>所谓模块名是指根据你的产品业务实际的命名，所以它不是固定的！比如美丽神器就包含四个主产品模块，分别是觅 – 圈 – 惠 – 我 ， 因此我们对应的模块命名为如下取值。</p>
<pre><code>mi            quan         hui        me        <span class="function"><span class="title">base</span><span class="params">(include)</span></span>
</code></pre><p>注意的是util的前缀形态名不受模块影响，所以util的模块名一般是base(include)，base(include)仅且而且必须对于util形态名！</p>
<hr>
<p>所谓布局名是指这个layout的用途，它可能是listview，也可能是popup，也可能是自己定义的一些名称类，因此这里的部分是最自由的。</p>
<hr>
<p>补充名会根据布局名来处理，它不是必须的，它是布局名的补充。并且可以一直添加。</p>
<p>比如以下命名为规范范例：</p>
<pre><code>activity_mi_ins_new<span class="class">.xml</span>
fragment_hui_listview_adapter<span class="class">.xml</span>    
view_hui_shangou_isnowing_listview<span class="class">.xml</span>
util_base_listview<span class="class">.xml</span>
util_include_head.xml
</code></pre><p>举例2：fragment形态名   hui模块名    listview布局名    adapter补充名    见名知义：这个layout布局是fragment形态，它属于惠模块，它是一个listview的adapter条目。<br>举例3：view形态名   hui模块名    shangou布局名    isnowing和listview补充名    见名知义：这个layout布局是view形态，它属于惠模块，它是惠模块下属的闪购模块正在展示部分的条目布局。</p>
<p>&emsp;&emsp;从layout命名你可以一窥我们想化繁为简的思想体现，我们不想在xml中命名中太着重于各种不同的控件标注，我们力争从最简单的角度去划分，这不仅仅是因为android控件有n多种，同时我们想用最简单的命名就能够见名知其为何种布局形态，它代表的产品逻辑，以及它着重刻画的是含义。我们将命名的含义进行了盘活且不拘礼于现有的命名规范。这里的核心就在于我们给予布局名很大的随意性权限，也正是这种无拘束性导致更灵活的命名。</p>
<h4 id="2-_Drawable或者Mipmap图片命名">2. Drawable或者Mipmap图片命名</h4><p>&emsp;&emsp;在早期我们命名图片资源时，我们启用的是</p>
<pre><code>模块名_icon数字
</code></pre><p>比如惠模块的，取名就是hui_icon01一直向后添加。当时这样命名的原因也是因为是为了防止反编译res包后图片资源直接把反编译者拿出使用，摸棱两可的命名基本上很难被反编译后使用，增加反编译盗图的难度(但不管如何，如果人家想盗你图，你即使再命名混乱，我想也是没什么卵用的！)。</p>
<p>而现在我们开始直接将模块名去掉，我们的保证图片资源直接从icon0开始，如果是测试的图片直接用test0开始(测试图片是指最终会在正式发行时删除的占位图片)。</p>
<pre><code>icon12
<span class="built_in">test</span>2
</code></pre><p>在这里我其实蛮建议你使用我们之前的命名方案的，因为它能够更好的区分模块，在多人协同时方便不同的模块人员管理自己的图片资源(毕竟自己上传了哪些图片自己还是比较清楚的)。同时为防止盗图增加难度。</p>
<p>比如以下命名为规范范例：</p>
<pre><code>hui_ico<span class="label">n1</span>
mi_ico<span class="label">n21</span>
</code></pre><p>或者</p>
<pre><code>icon1
<span class="built_in">test</span>12
</code></pre><h4 id="3-资源包">3.资源包</h4><p>全小写是基本原则，这个不需要多强调。中间使用_划分</p>
<hr>
<p>anim包中：</p>
<pre><code>动画类型_方向
</code></pre><p>注：方向是可以一直添加的</p>
<p>比如以下命名为规范范例：</p>
<pre><code>fade<span class="number">_</span><span class="keyword">in</span>
slide<span class="number">_</span><span class="keyword">in</span><span class="number">_f</span>rom<span class="number">_</span>bottom
<span class="keyword">out</span><span class="number">_</span>to<span class="number">_</span>right
</code></pre><hr>
<p>color包中：</p>
<pre><code>颜色类型_color
</code></pre><p>比如以下命名为规范范例：</p>
<pre><code>gary_color
</code></pre><hr>
<p>menu包中：</p>
<pre><code>menu_开头
</code></pre><p>比如以下命名为规范范例：</p>
<pre><code>menu_toolbar_mainpage
</code></pre><h4 id="4-value包命名">4.value包命名</h4><p>value包中一般含有attrs ids colors dimens styles等，但是我们知道我们在引用第三方的一些自定义控件时，它也有自己的value包，我们不建议你将这些自定义的value中的值粘贴复制到xml内容中，建议你分多个值包。比如我们自己有attrs.xml，引用的第三方的pulltorefresh有attrs.xml。</p>
<p>所以面对此时的正确命名是：</p>
<pre><code>my_attrs<span class="class">.xml</span>
pull_to_refresh_attrs<span class="class">.xml</span>
fab_attrs<span class="class">.xml</span>
vpi_attrs.xml
</code></pre><p>colors.xml、ids、dimens、styles和theme也按照各自不同的xml名去处理。</p>
<p>这样做最大的好处就在于，分开不同的资源定义，它将非常方便于我们随时替换不同的第三方自定义控件。</p>
<p>而对于xml里面的命名，不管是哪种xml类型，对于外层的标识同一用大写开头，里面的item同一小写开头，驼峰</p>
<pre><code><span class="tag">&lt;<span class="title">style</span> <span class="attribute">name</span>=<span class="value">"CustomTabPageIndicator"</span> <span class="attribute">parent</span>=<span class="value">"Widget.TabPageIndicator"</span>&gt;</span><span class="css">
    &lt;<span class="tag">item</span> <span class="tag">name</span>="<span class="rule"><span class="attribute">android</span>:<span class="value">fadingEdgeLength<span class="string">"&gt;8dp&lt;/item&gt;
</span></span></span></span><span class="tag">&lt;/<span class="title">style</span>&gt;</span>


 <span class="tag">&lt;<span class="title">declare-styleable</span> <span class="attribute">name</span>=<span class="value">"PagerSlidingTabStrip"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">attr</span> <span class="attribute">name</span>=<span class="value">"pstsIndicatorColor"</span> <span class="attribute">format</span>=<span class="value">"color"</span> /&gt;</span>
<span class="tag">&lt;/<span class="title">declare-styleable</span>&gt;</span>
</code></pre><p>当然item你也可用用下划线的方式来处理，也是没问题的</p>
<pre><code>&lt;declare-styleable name=<span class="string">"PagerSlidingTabStrip"</span>&gt;
    &lt;attr name=<span class="string">"psts_indicator_color"</span> format=<span class="string">"color"</span> /&gt;
&lt;/declare-styleable&gt;

&lt;<span class="attribute">color</span> name=<span class="string">"result_view"</span>&gt;<span class="hexcolor">#b00000</span>00&lt;/<span class="attribute">color</span>&gt;
</code></pre><h4 id="5-_xml文件中id命名">5. xml文件中id命名</h4><p>waiting for upload , Continue tomorrow….</p>
<h3 id="二-类中命名">二.类中命名</h3><h4 id="1-_类中基础命名">1. 类中基础命名</h4><h4 id="2-_类中方法命名">2. 类中方法命名</h4><h3 id="三-分包结构">三.分包结构</h3><h3 id="四-QuickUtils枢纽">四.QuickUtils枢纽</h3><h3 id="五-Application初始化">五.Application初始化</h3></span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/10/06/ZT10_1/" itemprop="url">
                【杂谈10月】程序员眼中的Material Design
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-10-06T23:13:48+08:00" content="2015-10-06">
            2015-10-06
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <p>程序员的角度的Material Design</p>
<h2 id="前言">前言</h2><p>&emsp;&emsp;这是一篇给予设计品读的文章，只是从程序员角度告知设计同仁何为Material Design设计。2个月前，我们决定将美丽神器APP-android端全部翻新，不仅要完成从Eclipse转到AS，基础框架也将全部自己重建与设计，同时设计风格也将遵循MD的设计风格而存在。这是一项艰巨的任务，而让设计同仁在ios设计风格的熏陶下，理解MD风格将是其中最为艰难的部分，因此这篇文章最初是在一次与设计同仁的技术交流会议上总结的，现在开放出来也希望可以帮到更多的设计同仁去理解。</p>
<p><img src="http://i.imgur.com/MNgSWGg.png" alt=""></p>
<p>中文网站：<a href="http://wiki.jikexueyuan.com/project/material-design/" title="http://wiki.jikexueyuan.com/project/material-design/">http://wiki.jikexueyuan.com/project/material-design/</a></p>
<p>英文(翻墙)：<a href="http://www.google.com/design/spec/material-design/" title="http://www.google.com/design/spec/material-design/">http://www.google.com/design/spec/material-design/</a></p>
<p>设计总结：<a href="http://www.uisdc.com/comprehensive-material-design-note" title="http://www.uisdc.com/comprehensive-material-design-note">http://www.uisdc.com/comprehensive-material-design-note</a></p>
<p>几个可以参考的android-app(demo) : </p>
<p>最美应用   最美壁纸    最美创意</p>
<p>印象笔记   什么值得买  aisen </p>
<p>pocket casts  网易云音乐  materialcat  </p>
<h2 id="一-了解">一.了解</h2><p>&emsp;&emsp;Material Design：纸墨设计风格，诞生于2014年6月google 2014/IO大会。 涉及到了跨平台和设备的视觉,动态,交互设计等方面。Material Design对排版、材质、配色、光效、间距、文字大小、交互方式、动画轨迹都做出了建议，以帮助设计者设计出符合Material Design风格的应用。</p>
<iframe height=498 width=510 src="http://player.youku.com/embed/XNzMxNzUyNzQ0" frameborder=0 allowfullscreen></iframe>

<p>Material Design演示</p>
<p>&emsp;&emsp;Material Design的灵感来自于对纸和墨水的研究,基于触觉现实感.并且它还在继续地发展扩充,有很大的想象空间.</p>
<p>&emsp;&emsp;基于现实,让材料的表面和边缘提供视觉线索. 熟悉的触觉属性可以帮助用户快速地明白正在发生什么.</p>
<p>&emsp;&emsp;光,表面和运动的一些基本规则是很关键性的因素,它们可以传达物体在空间如何存在,运动和交互.运动是很关键的因素,可以吸引注意力和保持连续性. 反馈需要微小但是清晰, 转换需要有效率但是还要保持连贯.</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/10/06/ZT10_1/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/10/03/MVP_1/" itemprop="url">
                【范式10月】Android-MVP范式编程(一)
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-10-03T01:05:48+08:00" content="2015-10-03">
            2015-10-03
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <p>我将保证MVP核心范式编程的文章将不少于5篇文章，在我还没有正式给MVP下定义前，我相信一个优秀的范例将非常有效的让我们对MVP有一个非常深入的了解。</p>
<p>首先让我们搭建一个基础MVP架构的目录，然后我们逐步解析MVP的含义，并最终完成一套符合The Clean Architecture核心思想的MVP架构封装。这里将是MVP范式编程的第一个章节,我将通过一个层级范例来解构MVP。</p>
<h2 id="解析MVP层级范例">解析MVP层级范例</h2><p><img src="http://i.imgur.com/larhurt.png" alt=""></p>
<p>mvp的分层我们按照model-presenter-view三个包级别分层，这样的分层将非常方便于各层级的关系展示。</p>
<p>MODEL:</p>
<pre><code>model包中装载的是我们通常所谓的java-bean对象，这些model对象继承Parcelable实现序列化。
</code></pre><p>PRESENTER:</p>
<pre><code>presenter包中装载的是我们的逻辑处理对象，它将沟通<span class="built_in">view</span>，并获取后台逻辑数据，将json解析为model对象，并根据数据请求的结果最终通知<span class="built_in">view</span>层完成UI的更新.
</code></pre><p>VIEW:</p>
<pre><code><span class="built_in">view</span>包中装载两个组成部分，一个是接口abstract-<span class="built_in">view</span>，它将沟通activity-<span class="built_in">view</span>和presenter，里面定义的都是等待activity-<span class="built_in">view</span>实现的逻辑方法。  另一个是activity-<span class="built_in">view</span>，它将完成<span class="built_in">view</span>的所有实现。
</code></pre><p>MVP本质：</p>
<p>1.将view和data抽象分离处理，原activity中的两个组成部分：界面和数据逻辑分别放在view和presenter层级中。</p>
<p>2.view层主要是原activity的界面层级。它将分成两个组成部分，一个为activity-view(实际View业务处理)，另一个为abstract-view(定义抽象方法完成view层与presenter层沟通);</p>
<p>3.presenter层主要是原activity的数据逻辑层级。它将完成后台的数据逻辑请求，并将json转成model，通过请求的数据结果，将model返回给view层级，完成UI界面的更新。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/10/03/MVP_1/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/09/16/15September/" itemprop="url">
                【开源9月】September
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-09-16T22:13:48+08:00" content="2015-09-16">
            2015-09-16
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <p>包含如下内容：</p>
<pre><code>开源推荐

<span class="keyword">APP</span>推荐

优秀文章推荐

点评开源
</code></pre><blockquote>
<p>If you have interest in these libraries you can visit <a href="https://github.com/stars/xiaomeixw">my github’s stars</a> </p>
</blockquote>
<h2 id="<!-more->">
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/09/16/15September/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/09/12/JK/" itemprop="url">
                【计划9月】准备上线RCMS专题
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-09-12T00:34:48+08:00" content="2015-09-12">
            2015-09-12
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <h2 id="准备上线一个栏目：RCMS">准备上线一个栏目：RCMS</h2><pre><code>Read <span class="list">(<span class="keyword">Code</span> Thinking)</span> Change Myself Style
</code></pre><p>准备上线的三个系列为：</p>
<pre><code><span class="blockquote">&gt; Java Puzzlers</span>

<span class="blockquote">&gt; Java Concurrency in Practice</span>

<span class="blockquote">&gt; Effective Java</span>
</code></pre><p>&emsp;&emsp;系列的原作者皆是Joshua Bloch,三本书都和Android没有直接的关键联系，但确是进阶代码范式编程的核心思维,很多优秀的Android开源架构都基于这些思维模式，所以总结出来。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/09/12/JK/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/09/10/OP9_1/" itemprop="url">
                【正谈9月】Open-Source-Android
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-09-10T23:23:12+08:00" content="2015-09-10">
            2015-09-10
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <p>OpenAndroid:</p>
<p>总结所有自己已知或使用过的Android解决方案：</p>
<p>1.Image图片处理框架：</p>
<p>Android-Universal-Image-Loader:</p>
<p>&emsp;&emsp;<a href="https://github.com/nostra13/Android-Universal-Image-Loader">https://github.com/nostra13/Android-Universal-Image-Loader</a></p>
<p>Picasso</p>
<p>&emsp;&emsp;<a href="https://github.com/square/picasso">https://github.com/square/picasso</a></p>
<p>Afinal</p>
<p>&emsp;&emsp;<a href="https://github.com/yangfuhai/afinal">https://github.com/yangfuhai/afinal</a></p>
<p>Glide</p>
<p>&emsp;&emsp;<a href="https://github.com/bumptech/glide">https://github.com/bumptech/glide</a></p>
<p>Fresco</p>
<p>&emsp;&emsp;<a href="https://github.com/facebook/fresco">https://github.com/facebook/fresco</a></p>
<p>2.EventBus替代callback接口回调的事件处理与沟通</p>
<p>EventBus</p>
<p>&emsp;&emsp;<a href="https://github.com/greenrobot/EventBus">https://github.com/greenrobot/EventBus</a></p>
<p>Otto</p>
<p>&emsp;&emsp;<a href="https://github.com/square/otto">https://github.com/square/otto</a></p>
<p>RxJava</p>
<p>&emsp;&emsp;<a href="https://github.com/ReactiveX/RxJava">https://github.com/ReactiveX/RxJava</a></p>
<p>RxAndroid</p>
<p>&emsp;&emsp;<a href="https://github.com/ReactiveX/RxAndroid">https://github.com/ReactiveX/RxAndroid</a></p>
<p>tinybus</p>
<p>&emsp;&emsp;<a href="https://github.com/beworker/tinybus">https://github.com/beworker/tinybus</a></p>
<p>3.Network 网络请求</p>
<p>volley</p>
<p>&emsp;&emsp;<a href="https://github.com/mcxiaoke/android-volley">https://github.com/mcxiaoke/android-volley</a></p>
<p>android-async-http</p>
<p>&emsp;&emsp;<a href="https://github.com/loopj/android-async-http">https://github.com/loopj/android-async-http</a></p>
<p>okhttp</p>
<p>&emsp;&emsp;<a href="https://github.com/square/okhttp">https://github.com/square/okhttp</a></p>
<p>retrofit</p>
<p>&emsp;&emsp;<a href="https://github.com/square/retrofit">https://github.com/square/retrofit</a></p>
<p>wasp</p>
<p>&emsp;&emsp;<a href="https://github.com/orhanobut/wasp">https://github.com/orhanobut/wasp</a></p>
<p>4.Injector注解</p>
<p>Dagger</p>
<p>&emsp;&emsp;<a href="https://github.com/square/dagger">https://github.com/square/dagger</a></p>
<p>AndroidAnnotations </p>
<p>&emsp;&emsp;<a href="https://github.com/excilys/androidannotations">https://github.com/excilys/androidannotations</a></p>
<p>ButterKnife</p>
<p>&emsp;&emsp;<a href="https://github.com/JakeWharton/butterknife">https://github.com/JakeWharton/butterknife</a></p>
<p>5.Test测试</p>
<p>android-testing-templates</p>
<p>&emsp;&emsp;<a href="https://github.com/googlesamples/android-testing-templates/tree/master/AndroidTestingBlueprint">https://github.com/googlesamples/android-testing-templates/tree/master/AndroidTestingBlueprint</a></p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/09/10/OP9_1/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/09/09/ZT9_1/" itemprop="url">
                【杂谈9月】微信的技术开放态度
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-09-09T23:13:48+08:00" content="2015-09-09">
            2015-09-09
          </time>
        </span>

        

        
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <p>&emsp;&emsp;今天是2015年9月9日，晚上加班到家，从Android开发技术周报 Issue#47偶然看到一篇文章，是关于微信团队—-Android微信上的SVG的策略，这是第一次看到微信开发团队对于微信架构体系的思想分享。这么多年来腾讯是一家非常奇葩的公司，从不开源任何移动端类库,甚至技术员连博客都没有，所以每次看到大FaceBook和Square神，就深深的鄙视腾讯，作为微信的安卓端程序员，他们难道就不羞射吗？</p>
<p>&emsp;&emsp;据了解，微信团队一直以来从不开源任何思想或者移动端类库，2015年7月29日，微信的技术团队建立了一个订阅号WeMobileDev，发表了一篇文章：外面的世界很精彩….表明他们愿意分享的态度。</p>
<p>&emsp;&emsp;而此时已经据微信公布第一个版本( 2011年1月21日)有4年半的时间了。一直以来中国BAT的技术团队从不开放自己的思想和模式，github上甚至没有Organizations是微信或者支付宝客户端团队,这是一个很可怕的现象和事实，这些技术高超的程序员都忘了作为一个程序员的本质，即：取之于开源，最终又回归于开源。反观：github上开源android类库的程序员(比如代码家等)都是在读书期间广泛的开源….中国的技术性企业也不认同开源的价值，一心只想保护自己所谓的知识产权，不提倡甚至反对自己的技术员工开放技术思想。但其实他们不知没有开源和共享，如何推动进步…希望这次微信端的程序员可以好好的反思自己，给我们带来足以和FB比肩的思想和类库…..如果做不到，那么微信你拿神马和FB在世界竞争<del>程序员都不开放，怎么谈open…..腾讯你TM的给中国人涨点脸好不</del></p>
<p>&emsp;&emsp;下面是一些已经开放出思想的文章，但具有爆炸性的类库，还没有动作，我想至少对于微信而言这是一个进步，希望可以更给力。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2015/09/09/ZT9_1/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">&raquo;</a>
  </nav>


            </div>

            

            
        </div>

        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/avatar.jpg" alt="熊伟xiongwei" itemprop="image"/>
          <p class="site-author-name" itemprop="name">熊伟xiongwei</p>
        </div>
        <p class="site-description motion-element" itemprop="description">重新发现、定义并创造这个世界...</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">18</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/xiaomeixw" target="_blank">github</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.sabria.net/" target="_blank">anotherblog</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/1561605537" target="_blank">weibo</a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


    </main>

    <footer id="footer" class="footer">
        <div class="footer-inner">
            <div class="copyright" >
  
  &copy; &nbsp; 
  <span itemprop="copyrightYear">2015</span>
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">熊伟xiongwei</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



        </div>
    </footer>

    <div class="back-to-top"></div>
</div>

<script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  
  
  
  

  



  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.4"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.4"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.4" id="motion.global"></script>



  <script type="text/javascript" src="/js/search-toggle.js"></script>



<script type="text/javascript">
    $(document).ready(function () {
        if (CONFIG.sidebar === 'always') {
            displaySidebar();
        }
    });
</script>




  
  

  







<!-- lazyload -->
<script type="text/javascript" src="/js/lazyload.js"></script>
<script type="text/javascript">
    jQuery(function () {
        jQuery("#posts img").lazyload({
            placeholder: "/images/loading.gif",
            effect: "fadeIn"
        });
    });
</script>
</body>
</html>
